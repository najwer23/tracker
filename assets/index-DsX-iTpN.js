import{r as c,j as t}from"./react-DOKUib4L.js";import{c as w}from"./react-dom-b-hWN9q_.js";import{u as v,c as T,R as S}from"./react-router-CxAikw5p.js";import{L as O}from"./leaflet-SGQCfi_b.js";import{M as C,T as E,a as A,P as I,C as F,b as N,u as D}from"./react-leaflet-CC3pfOIP.js";import"./cookie-BX9QSSmL.js";import"./scheduler-SPyfQU6S.js";import"./@react-leaflet-BcmaozC2.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))p(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const g of n.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&p(g)}).observe(document,{childList:!0,subtree:!0});function o(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function p(e){if(e.ep)return;e.ep=!0;const n=o(e);fetch(e.href,n)}})();const H=()=>{const{pathname:r}=v();return c.useEffect(()=>{window.scrollTo(0,0)},[r]),null},_=15,k=5,z=2e3,W=3,q=O.icon({iconUrl:"marker.svg",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41],shadowAnchor:[12,41]});function U(r,i,o,p){const e=u=>u*Math.PI/180,g=e(o-r),x=e(p-i),f=Math.sin(g/2)**2+Math.cos(e(r))*Math.cos(e(o))*Math.sin(x/2)**2;return 6371e3*(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)))}const V=({position:r})=>{const i=D(),o=c.useRef(!1);return c.useEffect(()=>{o.current||(i.setView([r.latitude,r.longitude],17),o.current=!0)},[i,r]),null},B=()=>{const[r,i]=c.useState(null),[o,p]=c.useState(null),[e,n]=c.useState(0),[g,x]=c.useState([]),[f,m]=c.useState(null),u=c.useRef(null),j=c.useRef(0),a=c.useRef([]),b=l=>{a.current.push(l),a.current.length>W&&a.current.shift();const y=a.current.reduce((h,d)=>h+d.latitude,0)/a.current.length,P=a.current.reduce((h,d)=>h+d.longitude,0)/a.current.length,s=a.current.reduce((h,d)=>h+d.accuracy,0)/a.current.length;return{latitude:y,longitude:P,accuracy:s}},M=c.useCallback(l=>{const y=Date.now();if(y-j.current<z)return;const P={latitude:l.coords.latitude,longitude:l.coords.longitude,accuracy:l.coords.accuracy};if(P.accuracy>_)return;const s=b(P);if(!o){p(s),i(s),u.current=s,x([[s.latitude,s.longitude]]),m(null),j.current=y;return}if(u.current){const h=U(u.current.latitude,u.current.longitude,s.latitude,s.longitude);h>k&&s.accuracy<=u.current.accuracy+10&&(n(d=>d+h),i(s),u.current=s,x(d=>[...d,[s.latitude,s.longitude]]),m(null),j.current=y)}},[o]),R=c.useCallback(l=>{m(`Error getting position: ${l.message}`)},[]);c.useEffect(()=>{if(!navigator.geolocation){m("Geolocation is not supported by your browser.");return}const l=navigator.geolocation.watchPosition(M,R,{enableHighAccuracy:!0,maximumAge:0,timeout:15e3});return()=>navigator.geolocation.clearWatch(l)},[M,R]);const L=()=>{i(null),p(null),n(0),x([]),m(null),u.current=null,j.current=0,a.current=[]};return t.jsxs("div",{style:{height:"100vh",width:"100%",padding:10},children:[t.jsx("h1",{children:"Traveled Distance and Path 2.0"}),f&&t.jsx("p",{style:{color:"red"},children:f}),!f&&!r&&t.jsx("p",{children:"Loading current position..."}),r&&o&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:{marginBottom:10},children:[t.jsxs("p",{children:[t.jsx("strong",{children:"Start Position:"}),t.jsx("br",{}),"Lat: ",o.latitude.toFixed(6),", Lon:"," ",o.longitude.toFixed(6)]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Current Position:"}),t.jsx("br",{}),"Lat: ",r.latitude.toFixed(6),", Lon:"," ",r.longitude.toFixed(6)]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Accuracy:"})," ±",r.accuracy.toFixed(1)," meters"]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Total Distance Traveled:"})," ",(e/1e3).toFixed(3)," km"]}),t.jsx("button",{onClick:L,"aria-label":"Reset tracking",children:"Reset Tracking"})]}),t.jsxs(C,{center:[o.latitude,o.longitude],zoom:17,scrollWheelZoom:!1,style:{height:"80vh",width:"100%"},"aria-label":"Map showing traveled path",children:[t.jsx(V,{position:o}),t.jsx(E,{attribution:"© OpenStreetMap contributors",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),t.jsx(A,{position:[r.latitude,r.longitude],icon:q,children:t.jsxs(I,{children:["Current Location",t.jsx("br",{}),"Accuracy: ±",r.accuracy.toFixed(1)," meters"]})}),t.jsx(F,{center:[r.latitude,r.longitude],radius:r.accuracy,pathOptions:{color:"blue",fillColor:"blue",fillOpacity:.1}}),t.jsx(N,{positions:g,pathOptions:{color:"red",weight:5,lineJoin:"round",lineCap:"round"}})]})]})]})},G=T([{path:"/",element:t.jsxs(t.Fragment,{children:[t.jsx(H,{}),t.jsx(B,{})]})}]),J=()=>t.jsx(S,{router:G}),K=()=>t.jsx(J,{});w.createRoot(document.getElementById("root")).render(t.jsx(K,{}));
