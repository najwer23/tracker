import{r as i,R as T,j as t}from"./react-DOKUib4L.js";import{c as S}from"./react-dom-b-hWN9q_.js";import{u as O,c as C,R as E}from"./react-router-CxAikw5p.js";import{L as R}from"./leaflet-SGQCfi_b.js";import{P as A,M as I,T as F,a as D,b as N,C as H,u as z}from"./react-leaflet-DCog-Hwi.js";import"./cookie-BX9QSSmL.js";import"./scheduler-SPyfQU6S.js";import"./@react-leaflet-BcmaozC2.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const p of n.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&a(p)}).observe(document,{childList:!0,subtree:!0});function r(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(e){if(e.ep)return;e.ep=!0;const n=r(e);fetch(e.href,n)}})();const _=()=>{const{pathname:o}=O();return i.useEffect(()=>{window.scrollTo(0,0)},[o]),null},k=10,W=10,q=0,U=1,V=R.icon({iconUrl:"marker.svg",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41],shadowAnchor:[12,41]});function B(o,s,r,a){const e=d=>d*Math.PI/180,p=e(r-o),m=e(a-s),g=Math.sin(p/2)**2+Math.cos(e(o))*Math.cos(e(r))*Math.sin(m/2)**2;return 6371e3*(2*Math.atan2(Math.sqrt(g),Math.sqrt(1-g)))}const G=({position:o})=>{const s=z(),r=i.useRef(!1);return i.useEffect(()=>{r.current||(s.setView([o.latitude,o.longitude],17),r.current=!0)},[s,o]),null};function J(o,s){let r,a;return function(...e){const n=this;a?(clearTimeout(r),r=window.setTimeout(function(){Date.now()-a>=s&&(o.apply(n,e),a=Date.now())},s-(Date.now()-a))):(o.apply(n,e),a=Date.now())}}const K=()=>{const[o,s]=i.useState(null),[r,a]=i.useState(null),[e,n]=i.useState(0),[p,m]=i.useState([]),[g,f]=i.useState(null),d=i.useRef(null),u=i.useRef([]),b=l=>{u.current.push(l),u.current.length>U&&u.current.shift();const y=u.current.reduce((h,x)=>h+x.latitude,0)/u.current.length,c=u.current.reduce((h,x)=>h+x.longitude,0)/u.current.length,j=u.current.reduce((h,x)=>h+x.accuracy,0)/u.current.length;return{latitude:y,longitude:c,accuracy:j}},P=i.useCallback(l=>{const y={latitude:l.coords.latitude,longitude:l.coords.longitude,accuracy:l.coords.accuracy};if(y.accuracy>k)return;const c=b(y);if(!r){a(c),s(c),d.current=c,m([[c.latitude,c.longitude]]),f(null);return}if(d.current){const j=B(d.current.latitude,d.current.longitude,c.latitude,c.longitude);j>W&&c.accuracy<=d.current.accuracy+10&&(n(h=>h+j),s(c),d.current=c,m(h=>[...h,[c.latitude,c.longitude]]),f(null))}},[r]),M=i.useMemo(()=>J(P,q),[P]),w=i.useCallback(l=>{f(`Error getting position: ${l.message}`)},[]);i.useEffect(()=>{if(!navigator.geolocation){f("Geolocation is not supported by your browser.");return}const l=navigator.geolocation.watchPosition(M,w,{enableHighAccuracy:!0,maximumAge:0,timeout:15e3});return()=>navigator.geolocation.clearWatch(l)},[M,w]);const v=()=>{s(null),a(null),n(0),m([]),f(null),d.current=null,u.current=[]},L=T.memo(({positions:l})=>t.jsx(A,{positions:l,pathOptions:{color:"red",weight:5,lineJoin:"round",lineCap:"round"},renderer:R.canvas()}));return t.jsxs("div",{style:{height:"100vh",width:"100%",padding:10},children:[t.jsx("h1",{children:"Traveled Distance and Path (Improved)"}),g&&t.jsx("p",{style:{color:"red"},children:g}),!g&&!o&&t.jsx("p",{children:"Loading current position..."}),o&&r&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:{marginBottom:10},children:[t.jsxs("p",{children:[t.jsx("strong",{children:"Start Position:"}),t.jsx("br",{}),"Lat: ",r.latitude.toFixed(6),", Lon: ",r.longitude.toFixed(6)]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Current Position:"}),t.jsx("br",{}),"Lat: ",o.latitude.toFixed(6),", Lon: ",o.longitude.toFixed(6)]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Accuracy:"})," ±",o.accuracy.toFixed(1)," meters"]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Total Distance Traveled:"})," ",(e/1e3).toFixed(3)," km"]}),t.jsx("button",{onClick:v,"aria-label":"Reset tracking",children:"Reset Tracking"})]}),t.jsxs(I,{center:[r.latitude,r.longitude],zoom:17,scrollWheelZoom:!1,style:{height:"80vh",width:"100%"},"aria-label":"Map showing traveled path",children:[t.jsx(G,{position:r}),t.jsx(F,{attribution:"© OpenStreetMap contributors",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),t.jsx(D,{position:[o.latitude,o.longitude],icon:V,children:t.jsxs(N,{children:["Current Location",t.jsx("br",{}),"Accuracy: ±",o.accuracy.toFixed(1)," meters"]})}),t.jsx(H,{center:[o.latitude,o.longitude],radius:o.accuracy,pathOptions:{color:"blue",fillColor:"blue",fillOpacity:.1}}),t.jsx(L,{positions:p})]})]})]})},Y=C([{path:"/",element:t.jsxs(t.Fragment,{children:[t.jsx(_,{}),t.jsx(K,{})]})}]),Z=()=>t.jsx(E,{router:Y}),$=()=>t.jsx(Z,{});S.createRoot(document.getElementById("root")).render(t.jsx($,{}));
